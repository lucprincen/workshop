/*!
 * Autoload v1.1.0
 *
 * Licensed GPLv3
 *
 * http://www.chefduweb.nl/plugins/autoload
 * Copyright 2015 Chef du Web
 */
define(["jquery","autoload","imagesloaded","isotope"],function(a){!function(a,b,c,d){function g(b,c){this.element=b,this.triggerY=9999,this.updating=!1,this.doneLoading=!1,this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="AutoLoad",f={loaderClass:"autoload-loader",loaderContent:"",pageNumber:1,column:"",section:"",message:"No posts found",wrap:!0,postId:0,onTrigger:null,onLoaded:null,onComplete:null,onAllComplete:null};a.extend(g.prototype,{init:function(){this.setupLoader(),this.setupLoadEvent()},setupLoadEvent:function(){var c=this;a(b).scroll(function(d){if(!1===c.doneLoading&&!1===a(c.element).hasClass("hold-autoload")){c.calculateTrigger();var e=a(b).scrollTop();e+=a(b).height(),e>=c.triggerY&&!1===c.updating&&(c.updating=!0,c.updateLoader(),c.autoload())}})},autoload:function(){var b=this;b.settings.pageNumber++;var d={action:"autoload",page:this.settings.pageNumber,section:this.settings.section,column:this.settings.column,post_id:this.settings.postId,message:this.settings.message,wrap:this.settings.wrap};null!==b.settings.onTrigger&&b.settings.onTrigger(b,d),a.post(Cuisine.ajax,d,function(d){if(0===d||"message"===d){b.doneLoading=!0,b.reset();var e=b.settings.message;b.settings.wrap&&(e='<p class="autoload-msg message">'+e+"</p>"),a(b.element).append(e),a(c).trigger("autoloadComplete"),null!==b.settings.onAllComplete&&b.settings.onAllComplete(b,d)}else null!==b.settings.onLoaded&&b.settings.onLoaded(b,d),a("."+b.settings.loaderClass).remove(),a(b.element).append(d),null!==b.settings.onComplete&&b.settings.onComplete(b,d),b.reset()})},reset:function(){this.updating=!1,this.setupLoader()},setupLoader:function(){if(a("."+this.settings.loaderClass).remove(),!1===this.doneLoading){var b="";b+='<div class="'+this.settings.loaderClass+'">',b+=this.settings.loaderContent,b+="</div>",a(this.element).append(b),a(this.element).hasClass("masonry")&&a("."+this.settings.loaderClass).css({position:"absolute",bottom:"-30px",left:"40%"}),this.calculateTrigger()}},updateLoader:function(){this.updating?a("."+this.settings.loaderClass).addClass("visible"):a("."+this.settings.loaderClass).removeClass("visible")},calculateTrigger:function(){var b=a("."+this.settings.loaderClass).offset().top;this.triggerY=b}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new g(this,b))}),this}}(jQuery,window,document)});